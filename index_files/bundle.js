Bundle={Defaults:{getBundleDiv:function(){return $(".bundle")},getBundleGridDiv:function(){return Bundle.Defaults.getBundleDiv().find(".bundle-grid")},getBundleDetailsDiv:function(){return Bundle.Defaults.getBundleDiv().find(".bundle-details")},getAddToCartDiv:function(){return $("#bundle-add-to-cart")},getWidget:function(){return ReChargeWidget.getWidgets()[0]}},Utils:{generateGuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})},calculateBundleQuantity:function($bundle){var bundle_qty=0;return $bundle.find(".bundle-item").each(function(){bundle_qty+=Number($(this).attr("data-qty"))}),bundle_qty},isSubscription:function(widget){return widget.subscriptionActive==!0},updateBundleQuantity:function($item,increment){var $bundle=$item.closest(".bundle-grid"),bundle_min=Number($bundle.attr("data-bundle-min")),bundle_max=Number($bundle.attr("data-bundle-max")),bundle_qty=Bundle.Utils.calculateBundleQuantity($bundle),item_qty=Number($item.attr("data-qty")),new_bundle_qty=bundle_qty+increment,new_item_qty=item_qty+increment;if(Bundle.Constraints.isItemGreaterThanZero(new_item_qty)&&Bundle.Constraints.isBundleGreaterThanMin(new_bundle_qty,bundle_min)&&Bundle.Constraints.isBundleLessThanMax(new_bundle_qty,bundle_max)){$item.attr("data-qty",new_item_qty),$item.find(".bundle_quantity").html(new_item_qty),$(".current-qty").html(new_bundle_qty);var is_disabled=!Bundle.Constraints.isBundleEqualMax(new_bundle_qty,bundle_max);Bundle.Defaults.getAddToCartDiv().prop("disabled",is_disabled),$bundle.find(".bundle-item").each(function(){var item_qty2=$(this).attr("data-qty"),is_disabled2=!!Bundle.Constraints.isBundleEqualParam(new_bundle_qty,bundle_max);$(this).find(".plus").find(".btn").prop("disabled",is_disabled2);var is_disabled2=!!(Bundle.Constraints.isBundleEqualParam(new_bundle_qty,bundle_min)||Bundle.Constraints.isBundleEqualParam(item_qty2,0));$(this).find(".minus").find(".btn").prop("disabled",is_disabled2)})}},updatePrice:function(){var widget=Bundle.Defaults.getWidget(),is_subscription=Bundle.Utils.isSubscription(widget),$bundle=Bundle.Defaults.getBundleGridDiv(),bundle_subscription_price=$bundle.attr("data-subscription-price"),bundle_onetime_price=$bundle.attr("data-onetime-price");is_subscription?$(".bundle-price").html(bundle_subscription_price):$(".bundle-price").html(bundle_onetime_price)}},Constraints:{isItemGreaterThanZero:function(qty){return qty<0?(console.log("Item quantity cannot be less than 0."),!1):!0},isBundleGreaterThanMin:function(qty,min){return qty<min?(console.log("Quantity cannot be less than the minimum."),!1):!0},isBundleLessThanMax:function(qty,max){return qty>max?(console.log("Quantity cannot be greater than maximum."),!1):!0},isBundleEqualMax:function(qty,max){return qty==max},isBundleEqualParam:function(qty,param){return qty==param}},Cart:{processAddToCart:function(){var $bundle=Bundle.Defaults.getBundleGridDiv(),qty=Bundle.Utils.calculateBundleQuantity($bundle),bundle_max=Number($bundle.attr("data-bundle-max"));if(!Bundle.Constraints.isBundleEqualMax(qty,bundle_max)){console.log("Cannot process Add to Cart. Qty does not equal max total.");return}var widget=Bundle.Defaults.getWidget(),items=Bundle.Cart.generateCart($bundle,widget);items.length>0?Bundle.Cart.processToCart(items):console.log("No items available to add to cart.")},generateCart:function($bundle,widget){var cart=[],is_subscription=Bundle.Utils.isSubscription(widget),bundle_id=Bundle.Utils.generateGuid();if(is_subscription)var selling_plan=widget.state.sellingPlanId;return $bundle.find(".bundle-item").each(function(){var qty=$(this).attr("data-qty");if(Number(qty)>0){var variant_id=$(this).attr("data-variant-id"),item={id:variant_id,quantity:qty,properties:{bundle_id}};is_subscription&&(item.selling_plan=selling_plan),cart.push(item)}}),cart},processToCart:function(items){$.ajax({type:"POST",url:"/cart/add.js",data:{items},dataType:"json",success:function(){window.location.href="/cart"},error:function(jqXHR,text_status,error_thrown){console.log(text_status,error_thrown)}})},removeBundleItems:function(bundle_id){jQuery.getJSON("/cart.js",function(cart){let bundle_items=[],qty=0,data={updates:{}};cart.items.forEach((item,i)=>{item.properties.bundle_id&&item.properties.bundle_id==bundle_id&&(data.updates[item.key]=0)}),$.ajax({type:"POST",url:"/cart/update.js",data,dataType:"json",success:function(){window.location.href="/cart"}})})}},removeBundleItems:function(bundle_id){jQuery.getJSON("/cart.js",function(cart){let bundle_items=[],qty=0,data={updates:{}};cart.items.forEach((item,i)=>{item.properties.bundle_id&&item.properties.bundle_id==bundle_id&&(data.updates[item.key]=0)}),$.ajax({type:"POST",url:"/cart/update.js",data,dataType:"json",success:function(){window.location.href="/cart"}})})},init:function(){$("body").on("click",".bundle .minus",function(){var item=$(this).closest(".bundle-item");Bundle.Utils.updateBundleQuantity(item,-1)}),$("body").on("click",".bundle .plus",function(){var item=$(this).closest(".bundle-item");Bundle.Utils.updateBundleQuantity(item,1)}),$("body").on("click","#bundle-add-to-cart",function(){event.preventDefault(),Bundle.Cart.processAddToCart()}),$("body").on("change",".rc-widget input",function(){Bundle.Utils.updatePrice()}),$("body").on("click",".cart__remove-bundle",function(){var bundle_id=$(this).closest(".cart__remove-bundle").attr("data-bundle-id");Bundle.Cart.removeBundleItems(bundle_id)})}},Bundle.init();
//# sourceMappingURL=/cdn/shop/t/31/assets/bundle.js.map?v=143852241966908934641710853339
